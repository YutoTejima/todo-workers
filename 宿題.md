# Web アプリケーションにおけるミドルウェア

<!-- OSとアプリケーションを繋ぐ役割を果たすソフトウェア。
Webサーバー、アプリケーションサーバー、データベース管理サーバーの3つのミドルウェアがある。

アプリケーションサーバは、Webサーバーからのリクエストを受けてプログラムを実行し、情報を処理して"動的コンテンツ"を生成する。 -->

リクエストからレスポンスまでの間に指定の関数を実行できる。

リクエスト(Request)→ 前処理 → メイン処理（Handler）→ 後処理 → レスポンス(Response)

Web アプリケーションにおいては、主に以下の 4 つの目的で使われる。
・Secutiry（認証やアクセス許可、レート制限など）
・Logging（アクセスログ、エラーログ、パフォーマンス計測）
・Processing（JSON パース、ヘッダーの追加、データ圧縮）
・Context（ユーザー情報の埋め込み）

Hono では、 await next() を境目に前処理と後処理に分かれる

# ジェネリクスの復習

const app = new Hono<{ Bindings: Env; Variables: Variables }>();
TypeScript に対して、「この Hono アプリは こういう環境変数(Bindings)と独自変数(Variables)を使いますよ」と教えてあげる（型安全性と入力補完）

これにより、TypeScript に認識される。

## Bindings

サーバーの環境変数や外部連携（DB など）の型定義

## Variables

アプリケーションの実行中にミドルウェア間で受け渡しするデータの型定義
例）context.set('session', session)
